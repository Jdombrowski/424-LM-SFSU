extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
MSE=(summary(mt)$sigma)^2
"MSE = " MSE
MSE=(summary(mt)$sigma)^2
"MSE = " + MSE
MSE=(summary(mt)$sigma)^2
"MSE = " + MSE
MSE=(summary(mt)$sigma)^2
"Number of Var,   Cp Stat"
"Step 1 : Single Variable Models"
m1 = lm(y~x1)
m2 = lm(y~x2)
m3 = lm(y~x3)
m4 = lm(y~x4)
m5 = lm(y~x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 2 : Two Variable Models"
m1 = lm(y~x1 + x2)
m2 = lm(y~x1 + x3)
m3 = lm(y~x1 + x4)
m4 = lm(y~x1 + x5)
m5 = lm(y~x2 + x3)
m6 = lm(y~x2 + x4)
m7 = lm(y~x2 + x5)
m8 = lm(y~x3 + x4)
m9 = lm(y~x3 + x5)
m10 = lm(y~x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"Step 3 : Three Variable Models"
m1 = lm(y~x1 + x2 + x3)
m2 = lm(y~x1 + x2 + x4)
m3 = lm(y~x1 + x2 + x5)
m4 = lm(y~x1 + x3 + x4)
m5 = lm(y~x1 + x3 + x5)
m6 = lm(y~x1 + x4 + x5)
m7 = lm(y~x2 + x3 + x4)
m8 = lm(y~x2 + x3 + x5)
m9 = lm(y~x2 + x4 + x5)
m10 = lm(y~x3 + x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"The minimum value calculated is not lower than the previous step, so we can stop"
"For sake of being verbose, we will calculate the other values"
"Step 4 : Four Variable Models"
m1 = lm(y~x1 + x2 + x3 +x4)
m2 = lm(y~x1 + x2 + x3 +x5)
m3 = lm(y~x1 + x2 + x4 +x5)
m4 = lm(y~x1 + x3 + x4 +x5)
m5 = lm(y~x2 + x3 + x4 +x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
MSE=(summary(mt)$sigma)^2
"Number of Var,   Cp Stat"
"Step 1 : Single Variable Models"
m1 = lm(y~x1)
m2 = lm(y~x2)
m3 = lm(y~x3)
m4 = lm(y~x4)
m5 = lm(y~x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 2 : Two Variable Models"
m1 = lm(y~x1 + x2)
m2 = lm(y~x1 + x3)
m3 = lm(y~x1 + x4)
m4 = lm(y~x1 + x5)
m5 = lm(y~x2 + x3)
m6 = lm(y~x2 + x4)
m7 = lm(y~x2 + x5)
m8 = lm(y~x3 + x4)
m9 = lm(y~x3 + x5)
m10 = lm(y~x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"Step 3 : Three Variable Models"
m1 = lm(y~x1 + x2 + x3)
m2 = lm(y~x1 + x2 + x4)
m3 = lm(y~x1 + x2 + x5)
m4 = lm(y~x1 + x3 + x4)
m5 = lm(y~x1 + x3 + x5)
m6 = lm(y~x1 + x4 + x5)
m7 = lm(y~x2 + x3 + x4)
m8 = lm(y~x2 + x3 + x5)
m9 = lm(y~x2 + x4 + x5)
m10 = lm(y~x3 + x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"The minimum value calculated is not lower than the previous step, so we can stop"
"For sake of being verbose, we will calculate the other values"
"Step 4 : Four Variable Models"
m1 = lm(y~x1 + x2 + x3 +x4)
m2 = lm(y~x1 + x2 + x3 +x5)
m3 = lm(y~x1 + x2 + x4 +x5)
m4 = lm(y~x1 + x3 + x4 +x5)
m5 = lm(y~x2 + x3 + x4 +x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
MSE=(summary(mt)$sigma)^2
"Number of Var,   Cp Stat"
"Step 1 : Single Variable Models"
m1 = lm(y~x1)
m2 = lm(y~x2)
m3 = lm(y~x3)
m4 = lm(y~x4)
m5 = lm(y~x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 2 : Two Variable Models"
m1 = lm(y~x1 + x2)
m2 = lm(y~x1 + x3)
m3 = lm(y~x1 + x4)
m4 = lm(y~x1 + x5)
m5 = lm(y~x2 + x3)
m6 = lm(y~x2 + x4)
m7 = lm(y~x2 + x5)
m8 = lm(y~x3 + x4)
m9 = lm(y~x3 + x5)
m10 = lm(y~x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"Step 3 : Three Variable Models"
m1 = lm(y~x1 + x2 + x3)
m2 = lm(y~x1 + x2 + x4)
m3 = lm(y~x1 + x2 + x5)
m4 = lm(y~x1 + x3 + x4)
m5 = lm(y~x1 + x3 + x5)
m6 = lm(y~x1 + x4 + x5)
m7 = lm(y~x2 + x3 + x4)
m8 = lm(y~x2 + x3 + x5)
m9 = lm(y~x2 + x4 + x5)
m10 = lm(y~x3 + x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"The minimum value calculated is not lower than the previous step, so we can stop"
"For sake of being verbose, we will calculate the other values"
"Step 4 : Four Variable Models"
m1 = lm(y~x1 + x2 + x3 +x4)
m2 = lm(y~x1 + x2 + x3 +x5)
m3 = lm(y~x1 + x2 + x4 +x5)
m4 = lm(y~x1 + x3 + x4 +x5)
m5 = lm(y~x2 + x3 + x4 +x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
"summary"
m1 = lm(y~x1 + x3)
extractAIC(m1, scake = MSE)
MSE=(summary(mt)$sigma)^2
"Number of Var,   Cp Stat"
"Step 1 : Single Variable Models"
m1 = lm(y~x1)
m2 = lm(y~x2)
m3 = lm(y~x3)
m4 = lm(y~x4)
m5 = lm(y~x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 2 : Two Variable Models"
m1 = lm(y~x1 + x2)
m2 = lm(y~x1 + x3)
m3 = lm(y~x1 + x4)
m4 = lm(y~x1 + x5)
m5 = lm(y~x2 + x3)
m6 = lm(y~x2 + x4)
m7 = lm(y~x2 + x5)
m8 = lm(y~x3 + x4)
m9 = lm(y~x3 + x5)
m10 = lm(y~x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"Step 3 : Three Variable Models"
m1 = lm(y~x1 + x2 + x3)
m2 = lm(y~x1 + x2 + x4)
m3 = lm(y~x1 + x2 + x5)
m4 = lm(y~x1 + x3 + x4)
m5 = lm(y~x1 + x3 + x5)
m6 = lm(y~x1 + x4 + x5)
m7 = lm(y~x2 + x3 + x4)
m8 = lm(y~x2 + x3 + x5)
m9 = lm(y~x2 + x4 + x5)
m10 = lm(y~x3 + x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"The minimum value calculated is not lower than the previous step, so we can stop"
"For sake of being verbose, we will calculate the other values"
"Step 4 : Four Variable Models"
m1 = lm(y~x1 + x2 + x3 +x4)
m2 = lm(y~x1 + x2 + x3 +x5)
m3 = lm(y~x1 + x2 + x4 +x5)
m4 = lm(y~x1 + x3 + x4 +x5)
m5 = lm(y~x2 + x3 + x4 +x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
"summary"
m1 = lm(y~x1 + x3)
extractAIC(m1, scake = MSE)
MSE=(summary(mt)$sigma)^2
"Number of Var,   Cp Stat"
"Step 1 : Single Variable Models"
m1 = lm(y~x1)
m2 = lm(y~x2)
m3 = lm(y~x3)
m4 = lm(y~x4)
m5 = lm(y~x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 2 : Two Variable Models"
m1 = lm(y~x1 + x2)
m2 = lm(y~x1 + x3)
m3 = lm(y~x1 + x4)
m4 = lm(y~x1 + x5)
m5 = lm(y~x2 + x3)
m6 = lm(y~x2 + x4)
m7 = lm(y~x2 + x5)
m8 = lm(y~x3 + x4)
m9 = lm(y~x3 + x5)
m10 = lm(y~x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"Step 3 : Three Variable Models"
m1 = lm(y~x1 + x2 + x3)
m2 = lm(y~x1 + x2 + x4)
m3 = lm(y~x1 + x2 + x5)
m4 = lm(y~x1 + x3 + x4)
m5 = lm(y~x1 + x3 + x5)
m6 = lm(y~x1 + x4 + x5)
m7 = lm(y~x2 + x3 + x4)
m8 = lm(y~x2 + x3 + x5)
m9 = lm(y~x2 + x4 + x5)
m10 = lm(y~x3 + x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"The minimum value calculated is not lower than the previous step, so we can stop"
"For sake of being verbose, we will calculate the other values"
"Step 4 : Four Variable Models"
m1 = lm(y~x1 + x2 + x3 +x4)
m2 = lm(y~x1 + x2 + x3 +x5)
m3 = lm(y~x1 + x2 + x4 +x5)
m4 = lm(y~x1 + x3 + x4 +x5)
m5 = lm(y~x2 + x3 + x4 +x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
"summary"
m1 = lm(y~x1 + x3)
extractAIC(m1, scale = MSE)
MSE=(summary(mt)$sigma)^2
"Number of Var,   Cp Stat"
"Step 1 : Single Variable Models"
m1 = lm(y~x1)
m2 = lm(y~x2)
m3 = lm(y~x3)
m4 = lm(y~x4)
m5 = lm(y~x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 2 : Two Variable Models"
m1 = lm(y~x1 + x2)
m2 = lm(y~x1 + x3)
m3 = lm(y~x1 + x4)
m4 = lm(y~x1 + x5)
m5 = lm(y~x2 + x3)
m6 = lm(y~x2 + x4)
m7 = lm(y~x2 + x5)
m8 = lm(y~x3 + x4)
m9 = lm(y~x3 + x5)
m10 = lm(y~x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"Step 3 : Three Variable Models"
m1 = lm(y~x1 + x2 + x3)
m2 = lm(y~x1 + x2 + x4)
m3 = lm(y~x1 + x2 + x5)
m4 = lm(y~x1 + x3 + x4)
m5 = lm(y~x1 + x3 + x5)
m6 = lm(y~x1 + x4 + x5)
m7 = lm(y~x2 + x3 + x4)
m8 = lm(y~x2 + x3 + x5)
m9 = lm(y~x2 + x4 + x5)
m10 = lm(y~x3 + x4 + x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
extractAIC(m6,scale=MSE)
extractAIC(m7,scale=MSE)
extractAIC(m8,scale=MSE)
extractAIC(m9,scale=MSE)
extractAIC(m10,scale=MSE)
"The minimum value calculated is not lower than the previous step, so we can stop"
"For sake of being verbose, we will calculate the other values"
"Step 4 : Four Variable Models"
m1 = lm(y~x1 + x2 + x3 +x4)
m2 = lm(y~x1 + x2 + x3 +x5)
m3 = lm(y~x1 + x2 + x4 +x5)
m4 = lm(y~x1 + x3 + x4 +x5)
m5 = lm(y~x2 + x3 + x4 +x5)
extractAIC(m1,scale=MSE)
extractAIC(m2,scale=MSE)
extractAIC(m3,scale=MSE)
extractAIC(m4,scale=MSE)
extractAIC(m5,scale=MSE)
"Step 5"
m1 = lm(y~x1 + x2 + x3 + x4 +x5)
extractAIC(m1 , scale = MSE)
"summary"
"best model with respect to Cp Value"
"y~x1+x3"
m1 = lm(y~x1 + x3)
extractAIC(m1, scale = MSE)
library(leaps)
cpMeth <- regsubsets(V1~., data = hwdata, nbest =1,method = "exhaustive")
cpMeth.summary = summary(cpMeth)
plot(cpMeth.summary$cp, type = "b" ,xlab="number of variables", ylab = "Cp value")
cpMeth.summary$cp
cpMeth <- regsubsets(V1~., data = hwdata, nbest =1,method = "forward")
cpMeth.summary = summary(cpMeth)
plot(cpMeth.summary$cp, type = "b" ,xlab="number of variables", ylab = "Cp value")
cpMeth.summary$cp
cpMeth.summary
cpMeth.summary$cp
m1 = lm(y~x1 + x3)
summary(m1)
m1=lm(y~x1 +x2)
m2=lm(y~x1 +x3)
m3=lm(y~x1 +x4)
m4=lm(y~x1 +x5)
summary(m1)[["coefficients"]][, "t value"]
summary(m2)[["coefficients"]][, "t value"]
summary(m3)[["coefficients"]][, "t value"]
summary(m4)[["coefficients"]][, "t value"]
summary(m3)
m1 - lm(y~x1+x3)
m1 = lm(y~x1+x3)
summary(m1)
mfull <- lm(y~x1+x2+x3+x4+x5)
step(mfull, direction = "both")
mfull <- lm(y~x1+x2+x3+x4+x5)
step(mfull, direction = "forward")
mfull <- lm(y~x1+x2+x3+x4+x5)
step(mfull, direction = "f")
mfull <- lm(y~x1+x2+x3+x4+x5)
step(mfull, direction = "b")
mfull <- lm(y~x1+x2+x3+x4+x5)
step(mfull, direction = "both")
install.packages("olsrr")
library(olsrr)
ols_stepwise(mfull)
help("ols_stepwise")
ols_stepwise(mfull, pent = 0.15, prem= 0.15)
ols_stepwise(model = mfull, pent = 0.15, prem= 0.15)
model = (y1~., data = hwdata)
model = (y1~. , data = hwdata)
model = (y1~.)
model
model = lm(y1~., data = hwdata)
ols_stepwise(model)
ols_stepwise(model, prem = 0.15)
ols_stepwise(model, prem = 0.15, pent = 0.15)
model = lm(V1~., data=hwdata)
model = lm(V1~.-V1, data=hwdata)
ols_stepwise(model, prem = 0.15, pent = 0.15)
ols_stepwise(model, prem = 0.15, pent = 0.15, details = TRUE)
ols_stepwise(model, prem = 0.15, pent = 0.15, details = FALSE)
ols_all_subset(model)
help("ols_all_subset")
k = ols_all_subset(model)
plot(k)
k$cp
ols_stepwise(model)
ols_stepwise(model, prem = 0.15, pent = 0.15, details = TRUE)
k
